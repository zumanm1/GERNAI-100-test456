Starting FastAPI application on port 5000
Health endpoint available at: http://localhost:5000/health
INFO:     Started server process [94002]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:5000 (Press CTRL+C to quit)
Initializing LLM providers...
OpenAI API key not found or is a placeholder. Skipping.
Groq API key not found or is a placeholder. Skipping.
OpenRouter API key not found or is a placeholder. Skipping.
INFO:     127.0.0.1:46406 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:41734 - "GET /chat/sessions HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:56586 - "GET /api/chat/sessions HTTP/1.1" 404 Not Found
2025-08-03 13:35:36,252 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-08-03 13:35:36,380 INFO sqlalchemy.engine.Engine SELECT DISTINCT ai_conversations.session_id AS ai_conversations_session_id 
FROM ai_conversations 
WHERE ai_conversations.user_id = ?
2025-08-03 13:35:36,381 INFO sqlalchemy.engine.Engine [generated in 0.00026s] ('default_user',)
INFO:     127.0.0.1:50990 - "GET /api/v1/chat/sessions HTTP/1.1" 200 OK
2025-08-03 13:35:36,383 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:     ('127.0.0.1', 51004) - "WebSocket /api/v1/chat/chat/ws" [accepted]
INFO:     connection open
INFO:     connection closed
2025-08-03 13:37:27,254 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-08-03 13:37:27,256 INFO sqlalchemy.engine.Engine INSERT INTO ai_conversations (id, user_id, session_id, message_role, message_content, created_at) VALUES (?, ?, ?, ?, ?, ?)
2025-08-03 13:37:27,256 INFO sqlalchemy.engine.Engine [generated in 0.00029s] ('c16958f3-53d3-43e7-b503-0f59b9066031', 'default_user', '73dbb384-a8c4-4478-ac04-c31ec31b27b4', 'user', 'Hello, this is a test message for our refactored WebSocket system', '2025-08-03 11:37:27.256147')
2025-08-03 13:37:27,257 INFO sqlalchemy.engine.Engine COMMIT
2025-08-03 13:37:27,265 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-08-03 13:37:27,396 INFO sqlalchemy.engine.Engine SELECT ai_conversations.id, ai_conversations.user_id, ai_conversations.session_id, ai_conversations.message_role, ai_conversations.message_content, ai_conversations.conversation_metadata, ai_conversations.created_at 
FROM ai_conversations 
WHERE ai_conversations.id = ?
2025-08-03 13:37:27,396 INFO sqlalchemy.engine.Engine [generated in 0.00225s] ('c16958f3-53d3-43e7-b503-0f59b9066031',)
2025-08-03 13:37:27,398 INFO sqlalchemy.engine.Engine SELECT ai_conversations.id AS ai_conversations_id, ai_conversations.user_id AS ai_conversations_user_id, ai_conversations.session_id AS ai_conversations_session_id, ai_conversations.message_role AS ai_conversations_message_role, ai_conversations.message_content AS ai_conversations_message_content, ai_conversations.conversation_metadata AS ai_conversations_conversation_metadata, ai_conversations.created_at AS ai_conversations_created_at 
FROM ai_conversations 
WHERE ai_conversations.session_id = ? AND ai_conversations.user_id = ? ORDER BY ai_conversations.created_at DESC
 LIMIT ? OFFSET ?
2025-08-03 13:37:27,400 INFO sqlalchemy.engine.Engine [generated in 0.00188s] ('73dbb384-a8c4-4478-ac04-c31ec31b27b4', 'default_user', 10, 0)
2025-08-03 13:37:27,403 INFO sqlalchemy.engine.Engine SELECT network_devices.id AS network_devices_id, network_devices.name AS network_devices_name, network_devices.ip_address AS network_devices_ip_address, network_devices.model AS network_devices_model, network_devices.status AS network_devices_status, network_devices.uptime_seconds AS network_devices_uptime_seconds, network_devices.last_seen AS network_devices_last_seen, network_devices.config_backup AS network_devices_config_backup, network_devices.device_metadata AS network_devices_device_metadata, network_devices.owner_id AS network_devices_owner_id, network_devices.created_at AS network_devices_created_at, network_devices.updated_at AS network_devices_updated_at 
FROM network_devices 
WHERE network_devices.owner_id = ?
2025-08-03 13:37:27,404 INFO sqlalchemy.engine.Engine [generated in 0.00175s] ('default_user',)
2025-08-03 13:37:27,409 INFO sqlalchemy.engine.Engine SELECT operations_log.id AS operations_log_id, operations_log.user_id AS operations_log_user_id, operations_log.device_id AS operations_log_device_id, operations_log.operation_type AS operations_log_operation_type, operations_log.status AS operations_log_status, operations_log.command AS operations_log_command, operations_log.result AS operations_log_result, operations_log.error_message AS operations_log_error_message, operations_log.execution_time_ms AS operations_log_execution_time_ms, operations_log.created_at AS operations_log_created_at 
FROM operations_log 
WHERE operations_log.user_id = ? ORDER BY operations_log.created_at DESC
 LIMIT ? OFFSET ?
2025-08-03 13:37:27,409 INFO sqlalchemy.engine.Engine [generated in 0.00026s] ('default_user', 5, 0)
2025-08-03 13:37:27,410 INFO sqlalchemy.engine.Engine INSERT INTO ai_conversations (id, user_id, session_id, message_role, message_content, created_at) VALUES (?, ?, ?, ?, ?, ?)
2025-08-03 13:37:27,412 INFO sqlalchemy.engine.Engine [cached since 0.1566s ago] ('5fbc7e17-5ae4-436f-ad5d-352ed52ef5eb', 'default_user', '73dbb384-a8c4-4478-ac04-c31ec31b27b4', 'assistant', "I apologize, but I'm experiencing technical difficulties connecting to AI services. Please check your API configuration and try again later.", '2025-08-03 11:37:27.410786')
2025-08-03 13:37:27,413 INFO sqlalchemy.engine.Engine COMMIT
2025-08-03 13:37:27,445 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-08-03 13:37:27,449 INFO sqlalchemy.engine.Engine SELECT ai_conversations.id, ai_conversations.user_id, ai_conversations.session_id, ai_conversations.message_role, ai_conversations.message_content, ai_conversations.conversation_metadata, ai_conversations.created_at 
FROM ai_conversations 
WHERE ai_conversations.id = ?
2025-08-03 13:37:27,449 INFO sqlalchemy.engine.Engine [cached since 0.0546s ago] ('5fbc7e17-5ae4-436f-ad5d-352ed52ef5eb',)
INFO:     127.0.0.1:43992 - "POST /api/v1/chat/send HTTP/1.1" 200 OK
2025-08-03 13:37:27,498 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:     127.0.0.1:47494 - "GET /chat HTTP/1.1" 200 OK
INFO:     127.0.0.1:47508 - "GET /css/style.css HTTP/1.1" 200 OK
INFO:     127.0.0.1:47522 - "GET /css/devices.css HTTP/1.1" 200 OK
INFO:     127.0.0.1:47514 - "GET /css/automation.css HTTP/1.1" 200 OK
INFO:     127.0.0.1:47532 - "GET /js/automation.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:47548 - "GET /favicon.ico HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:33398 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:33398 - "GET /css/automation.css HTTP/1.1" 304 Not Modified
INFO:     127.0.0.1:33404 - "GET /css/devices.css HTTP/1.1" 304 Not Modified
INFO:     127.0.0.1:33404 - "GET /js/automation.js HTTP/1.1" 304 Not Modified
INFO:     127.0.0.1:33432 - "GET /api/device-status-chart HTTP/1.1" 200 OK
INFO:     127.0.0.1:33420 - "GET /api/operations-timeline HTTP/1.1" 200 OK
INFO:     127.0.0.1:33404 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:33398 - "GET /dashboard HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:33404 - "POST /api/v1/analytics/404 HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:33398 - "GET /automation HTTP/1.1" 200 OK
INFO:     127.0.0.1:33398 - "GET /operations HTTP/1.1" 200 OK
INFO:     127.0.0.1:33398 - "GET /devices HTTP/1.1" 200 OK
INFO:     127.0.0.1:33398 - "GET /chat HTTP/1.1" 200 OK
INFO:     127.0.0.1:33398 - "GET /settings HTTP/1.1" 200 OK
INFO:     127.0.0.1:35684 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:35698 - "GET /api/device-status-chart HTTP/1.1" 200 OK
INFO:     127.0.0.1:35684 - "GET /api/operations-timeline HTTP/1.1" 200 OK
INFO:     127.0.0.1:35698 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:44770 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:35608 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:50774 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:35142 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:40668 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:42716 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:34918 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:48050 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:45320 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:43166 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:57818 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:38382 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:44252 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:56570 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:43710 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:51554 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:55004 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:57962 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:57980 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:45934 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:44254 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:35404 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:58086 - "GET /api/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:38800 - "GET /dashboard HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:38800 - "POST /api/v1/analytics/404 HTTP/1.1" 404 Not Found
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [94002]
